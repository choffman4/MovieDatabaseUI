<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Fantasy World UI</title>
    <script type="text/javascript">

        var authHeaderValue = null;
        var username = null;
        var password = null;

        //PEOPLE
        ////////////////////////////////////////////////////////////////////////////
        function getAllMovies() {
            clearPage();
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function () {
                if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                    var allMovies = JSON.parse(this.responseText);
                    renderMovies(allMovies);
                }
            }
            xmlHttp.open("GET", "http://localhost:8081/movies/", true);
            xmlHttp.send();
        }

        // function searchPeople() {
        //     clearPage();
        //     var searchTerm = document.getElementById("entity_search").value;
        //     var xmlHttp = new XMLHttpRequest();
        //     xmlHttp.open("GET", "http://localhost:8081/movies/" + searchTerm, true);
        //     xmlHttp.onreadystatechange = function () {
        //         if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
        //             var people = JSON.parse(this.responseText);
        //             renderPeople(people);
        //         }
        //     }
        //     xmlHttp.send();
        // }

        function renderMovies(allMovies) {
            for (var movie of allMovies) {
                var movie_html = "<hr/>Movie:<br/><li>" + "ID:&nbsp;" + movie.id + "</li>" + "<li>"
                    + "Title:&nbsp;" + movie.title + "</li>" + "<li>" + "Director:&nbsp;" + movie.director + "</li>";
                movie_list.innerHTML += movie_html;
            }
        }


        function clearPage() {
            var movie_list = document.getElementById("movie_list");
            var movieHTML = document.getElementById("movieHTML");
            movie_list.innerHTML = "";
            movieHTML.innerHTML = "";
        }

        window.onload = function() {
            username = getCookie("username");
            password = getCookie("password");
            loadPeople();
        }

        function loadPeople() {
            clearPage();
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function () {
                if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                    // var people = JSON.parse(this.responseText);
                }
            }
            xmlHttp.open("GET", "http://localhost:8081/movies/", true);
            xmlHttp.send();
        }

        function getCookie(cname) {
            let name = cname + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for(let i = 0; i <ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

    </script>
</head>
<body>

<div>
    <a href="index.html">MovieDB Homepage</a>
    </br>

<!--    <button onclick="addPersonHTML();">Add Person</button>-->
<!--    <button onclick="updatePersonHTML();">Update Person</button>-->
<!--    <button onclick="deletePersonHTML();">Delete Person</button>-->

</div>
<hr/>
<h1>Movie Database Page!!!</h1>
</br>
<div>
    <label for="entity_search">Search:</label>
    <input type="text" id="entity_search" name="entity_search">
    <button onclick="">Search</button>
</div>

<div id="userProfile">
    <a href="favorites.html"> Favorites </a><br/>
    <a href="login.html"> Login </a><br/>
    <a href="sign_up.html"> Sign Up </a>

</div>
<style>
    #userProfile {
        position: relative;
    }
    #userProfile {
        position: absolute;
        top: 40px;
        right: 20px;
    }
</style>

<div id="movieHTML"></div>

<div>
    <ul id="movie_list"></ul>
</div>

</body>
</html>